<?php 
	$lu = Zend_Registry::get('user');
	$viewuser = Zend_Registry::isRegistered('viewuser') ? Zend_Registry::get('viewuser') : array();
?>
<?php 
	$avatar = (isset($lu['avatar']) && $lu['avatar'] !== '') ? $lu['avatar'] : default_avatar('user');
	$background = (isset($lu['background']) && $lu['background'] !== '') ? $lu['background'] : default_avatar('background');
?>
<div class="zm_pfcover">
	<div class="pfavatar">
		<a href="/u/vietduc_angelboy?f=1">
			<span class="avtholder" 
				style="background-image:url('<?php echo $avatar;?>');">
					<?php echo $lu['name'];?></span></a>
		
			<a href="/user/update?id=<?php echo $lu['id'];?>&_cl_step=avatar" 
				class="bgeditavatar" title='Sửa avatar'>
				<p><em class="zmsprt zmico icoeditavatar"></em></p>
			</a>
		
	</div>
	
	<div id="idcover" class="pfctncover">
		<div class = "filledImage">
			<img src="<?php echo $background;?>" 
				style="-ms-interpolation-mode:bicubic;image-rendering:optimizeQuality;
				<?php 
					list($width, $height) = getimagesize($background);
					$heightFilledImage = 256;//height class filedImage img
					$widthFilledImage = 796;
					
					//Get height (chieu dai thuc cua anh ty le
					// voi chieu dai cua khung chua anh)
					$heightFilledImageNew = $widthFilledImage * $height/ $width;
					
					$gap = ($heightFilledImageNew - $heightFilledImage)/2;
					if($gap > 0){
						echo "margin-top: -{$gap}px;";
					}else{
						echo "margin-top: {$gap}px;";
					}
				?>" 
					id="idphotocover">
		   </div>
		<a class="ctneditcover" href="/user/update?id=<?php echo $lu['id'];?>&_cl_step=background">
			<span class="zmsprt zmico icoeditcover"></span>Sửa ảnh bìa</a>
		<div class="pfctnusername">
			<a href="<?php echo user_link($lu);?>" 
				class="username">
				<?php echo $lu['name'];?></a>
			<span class="mevip_18099010" style="display:none"></span>
		</div>
	</div>
	
	<div class="pfctnbtn">
		<div style='width: 100%;'>
			<span class="fl">
					Lượt xem: <strong>656</strong>
			</span>
			
			<span class="pull-right">
			<?php /*
				<a href='/user/subscribe?id=<?php echo $viewuser['id'];?>' class='cl_ajax'>
			*/?>
				<a href='javascript:void(0);'>				
					<button type="button" 
						class="vd-button vd-is-buffered vd-button-branded">
						<span class="button-icon-wrapper">
							<img class="vd-button-icon" 
							src="<?php echo ASSETS_CDN;?>/img/youtube-icon-small.png">
						</span>
						
						<span class="vd-button-content">
							<span aria-label="Đăng ký" class="subscribe-label">
								Đăng ký
								</span>
						</span>
					</button>
				</a>
				<span class="subscribe-count" data-count='371'>371</span>
			</span>
		</div>
	</div>
	
	<ul class="pfmenutab">
		<li id="playlist_video">
			<a href="javascript:void(0)" class="selected">
				<span style="" class="feed_sprt icotabarrow pftab"></span>
				Clip ưa thích</a></li>
		<li id="upload_video">
			<a href="javascript:void(0)">
				<span style="display: none" class="feed_sprt icotabarrow pftab"></span>
				Clip bạn tải lên</a></li>
	</ul>
	<div class="clear"> </div>
</div>
<div class="clear"> </div>
<style>
.filledImage {
    display: block;
    height: 256px;
    overflow: hidden;
    position: relative;
    width: 796px;
}				
.filledImage img {
    left: 0;
    min-height: 256px;
    position: absolute;
    top: 0;
    width: 100%;
}
</style>
<?php $this->inlineScript()->captureStart();?>
	$(".vd-button").on('click', function(){
		var _this = $(this);
		if(_this.hasClass('vd-button-active')){
			_this.removeClass('vd-button-active');

			var sub_count = $(".subscribe-count").attr('data-count');
			var new_count = parseInt(sub_count) - 1;
			$(".subscribe-count").attr('data-count', new_count);
			$(".subscribe-count").html(new_count);
		}else{
			_this.addClass('vd-button-active');
			
			var sub_count = $(".subscribe-count").attr('data-count');
			var new_count = parseInt(sub_count) + 1;
			$(".subscribe-count").attr('data-count', new_count);
			$(".subscribe-count").html(new_count);
		}
	});
<?php $this->inlineScript()->captureEnd();?>